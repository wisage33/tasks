// 6 Требуется найти одну ошибку в следующем коде:

const str = `
purschases(
  Apple(
    price: 100
  ),
  Banana(
    price: 200
  )
)
`;

/**
 * Находит первое выражение в скобках, начиная с заданной позиции в строке.
 *
 * @param {string} str - Строка, в которой нужно произвести поиск.
 * @param {number} pos - Позиция, с которой нужно начать поиск.
 * @return {string} - Найденное выражение в скобках.
 */
function bracket(str: string, pos: number): string {
  // Находим индекс открывающей скобки, начиная с заданной позиции
  const openIndex = str.indexOf("(", pos);

  // Если открывающая скобка не найдена, выбрасывается ошибка
  if (openIndex === -1) {
    throw new Error(`Invalid index: ${pos}`);
  }

  // Инициализируем счетчик для отслеживания вложенности скобок
  let count = 1;

  // Перебираем символы после открывающей скобки
  for (let i = openIndex + 1; i < str.length; i++) {
    // Если встречается открывающая скобка, увеличиваем счетчик
    if (str[i] === "(") {
      count++;
    }
    // Если встречается закрывающая скобка, уменьшаем счетчик
    else if (str[i] === ")") {
      // Если счетчик становится равным 1, то нашли нужную скобку
      if (--count === 0) {
        // Возвращаем подстроку от открывающей скобки до закрывающей
        return str.substring(openIndex, i + 1);
      }
    }
  }

  // Если скобка не найдена, выбрасывается ошибка
  throw new Error(`Invalid index: ${pos}`);
}

// Вызываем функцию и выводим результат в консоль
console.log(bracket(str, 2));
console.log(bracket(str, 14));
